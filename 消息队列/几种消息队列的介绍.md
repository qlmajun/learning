### 几种消息队列的介绍 ###
----

### 概览
消息中间件是一种由消息传送机制或消息队列模式组成的中间件技术，利用高效可靠的消息传递机制进行平台无关的数据交流，并基于数据通信来进行分布式系统的集成，目前业界比较流行的MQ产品：RabbitMQ、ActiveMQ、ZeroMQ、RocketMQ、Kafka。


### 1、RabbitMQ
是使用Erlang语音编写的一个开源的消息队列，本身支持很多协议：AMQP、XMPP、SMTP、STOMP，也正是如此使他变得非常重量级，更适合企业级开发。RabbitMQ是一个消息代理，从“生产者”接受消息并传递消息到“消费者”,期间可根据规则路由，缓存，持久化消息。

**优点：**

对路由(Routing)，负载均衡(Load balance)或者数据持久化都有很好的支持，易于使用和部署，适宜于很多场景如路由、负载均衡或消息持久化等，用消息队列只需几行代码即可搞定。

**缺点：**

可扩展性差，速度较慢，因为中央节点增加了延迟，消息封装后也比较大（由Header和Body组成），配置RabbitMQ则需要在目标机器上安装Erlang环境。

**使用场景：**

1、单发送单接收：简单的发送与接收，没有特别的处理。

2、单发送多接收：一个发送端，多个接收端，如分布式的任务派发。为了保证消息发送的可靠性，不丢失消息，使消息持久化了。同时为了防止接收端在处理消息时down掉，只有在消息处理完成后才发送ack消息。

3、Publish/Subscribe：发布、订阅模式，发送端发送广播消息，多个接收端接收。

4、Routing (按路线发送接收)：发送端按routing key发送消息，不同的接收端按不同的routing key接收消息。

5、Topics (按topic发送接收)：发送端不只按固定的routing key发送消息，而是按字符串“匹配”发送，接收端同样如此。

### 2、ZeroMQ
号称最快的消息队列系统，尤其针对大吞吐量的需求场景，是一个非常轻量级的消息系统，专门为高吞吐量/低延迟的场景开发，ZeroMQ具有一个独特的非中间件的模式，你不需要安装和运行一个消息服务器或中间件，因为你的应用程序将扮演了这个服务角色。

**有点：**

应用程序端点扮演了这个服务角色,这让部署起来非常简单。

**缺点：**

1、ZeroMQ仅提供非持久性的队列。

2、ZeroMQ非常灵活，但是你必须学习它的80页的手册。

**使用场景：**
Twitter的Storm中使用ZeroMQ作为数据流的传输。


### 3、ActiveMQ
ActiveMQ 是Apache出品，最流行的，能力强劲的开源消息总线。ActiveMQ是一个完全支持JMS1.1和J2EE 1.4规范的 JMS Provider实现,尽管JMS规范出台已经是很久的事情了,但是JMS在当今的J2EE应用中间仍然扮演着特殊的地位。


**优点：**

1、完全支持JMS1.1和j2EE1.4规范。

2、对spring的支持,ActiveMQ可以很容易内嵌到使用Spring的系统里面去,而且也支持Spring2.0的特性。

3、提供多种语言和协议编写的客户端。

**缺点：**

cpu的占用率就比较大了，发送或接受消息的时候都达到了100%。

### 4、Kafka

Kafka是一个分布式消息系统，由linkedin使用scala编写，用作LinkedIn的活动流（Activity Stream）和运营数据处理管道（Pipeline）的基础。具有高水平扩展和高吞吐量，完全的分布式系统，Broker、Producer、Consumer都原生自动支持分布式，自动实现负载均衡；支持Hadoop数据并行加载，对于像Hadoop的一样的日志数据和离线分析系统，但又要求实时处理的限制，这是一个可行的解决方案。Kafka通过Hadoop的并行加载机制统一了在线和离线的消息处理。Apache Kafka相对于ActiveMQ是一个非常轻量级的消息系统，除了性能非常好之外，还是一个工作良好的分布式系统。

**优点：**

1、以时间复杂度为O(1)的方式提供消息持久化能力，即使对TB级以上数据也能保证常数时间复杂度的访问性能。

2、高吞吐率。即使在非常廉价的商用机器上也能做到单机支持每秒100K条以上消息的传输。

3、支持Kafka Server间的消息分区，及分布式消费，同时保证每个Partition内的消息顺序传输。

4、同时支持离线数据处理和实时数据处理。

5、Scale out：支持在线水平扩展。


**使用场景：**

1、kafka可以作为"网站活性跟踪"的最佳工具;可以将网页/用户操作等信息发送到kafka中.并实时监控,或者离线统计分析等

2、 Kafka通常被用于可操作的监控数据。这包括从分布式应用程序来的聚合统计用来生产集中的运营数据提要。

3、kafka的特性决定它非常适合作为"日志收集中心"。

### 5、RocketMQ
RocketMQ是阿里自研的第三代分布式消息中间件，阿里称基于RocketMQ技术，目前双十一当天消息容量可达到万亿级。RocketMQ正式发布4.0版本，专家称新版本适用于电商领域，金融领域，大数据领域，兼有物联网领域的编程模型。RocketMQ第三代以拉模式为主，兼有推模式的高性能、低延迟消息引擎RocketMQ，在二代功能特性的基础上，为电商金融领域添加了可靠重试、基于文件存储的分布式事务等特性，并做了大量优化。RocketMQ主要由NameServer、Broker、Producer以及Consumer四部分构成。

**优点：**

1、顺序消息

2、消息的去重

3、事务消息
